From fedd68bf585c7b56d5f3a10a7c98cae8e8dd5dd6 Mon Sep 17 00:00:00 2001
From: Alex Samorukov <samm@os2.kiev.ua>
Date: Sun, 28 Oct 2018 20:51:43 +0100
Subject: [PATCH 1/3] Fix for tablets which not reporting deviceType (see
 #1431)

---
 gdk/quartz/gdkinput.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git gdk/quartz/gdkinput.c gdk/quartz/gdkinput.c
index 6f5f8ea201..9ee38d5c1f 100644
--- gdk/quartz/gdkinput.c
+++ gdk/quartz/gdkinput.c
@@ -606,7 +606,8 @@ _gdk_input_window_crossing (GdkWindow *window,
 void
 _gdk_input_quartz_tablet_proximity (NSPointingDeviceType deviceType)
 {
-  if (deviceType == NSPenPointingDevice)
+  /* some tablets reports  NSPointingDeviceTypeUnknown */
+  if ((deviceType == NSPenPointingDevice) || (deviceType == NSPointingDeviceTypeUnknown))
     active_device = _gdk_quartz_pen;
   else if (deviceType == NSCursorPointingDevice)
     active_device = _gdk_quartz_cursor;
-- 
GitLab


From e79209d8b691bc516054f1b444f482b784e58cea Mon Sep 17 00:00:00 2001
From: Alex Samorukov <samm@net-art.cz>
Date: Wed, 31 Oct 2018 17:56:38 +0000
Subject: [PATCH 2/3] Use deprecated functions to avoid problems with old sdk

---
 gdk/quartz/gdkinput.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git gdk/quartz/gdkinput.c gdk/quartz/gdkinput.c
index 9ee38d5c1f..c01f9cf3b0 100644
--- gdk/quartz/gdkinput.c
+++ gdk/quartz/gdkinput.c
@@ -607,7 +607,7 @@ void
 _gdk_input_quartz_tablet_proximity (NSPointingDeviceType deviceType)
 {
   /* some tablets reports  NSPointingDeviceTypeUnknown */
-  if ((deviceType == NSPenPointingDevice) || (deviceType == NSPointingDeviceTypeUnknown))
+  if ((deviceType == NSPenPointingDevice) || (deviceType == NSUnknownPointingDevice))
     active_device = _gdk_quartz_pen;
   else if (deviceType == NSCursorPointingDevice)
     active_device = _gdk_quartz_cursor;
-- 
GitLab


From 09acac1a0d4296369453586cc06dbf423bb002ba Mon Sep 17 00:00:00 2001
From: Alex Samorukov <samm@net-art.cz>
Date: Thu, 1 Nov 2018 17:10:43 +0000
Subject: [PATCH 3/3] Fix typo in the comments

---
 gdk/quartz/gdkinput.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git gdk/quartz/gdkinput.c gdk/quartz/gdkinput.c
index c01f9cf3b0..7d25888f82 100644
--- gdk/quartz/gdkinput.c
+++ gdk/quartz/gdkinput.c
@@ -606,7 +606,7 @@ _gdk_input_window_crossing (GdkWindow *window,
 void
 _gdk_input_quartz_tablet_proximity (NSPointingDeviceType deviceType)
 {
-  /* some tablets reports  NSPointingDeviceTypeUnknown */
+  /* some tablets report NSPointingDeviceTypeUnknown */
   if ((deviceType == NSPenPointingDevice) || (deviceType == NSUnknownPointingDevice))
     active_device = _gdk_quartz_pen;
   else if (deviceType == NSCursorPointingDevice)
-- 
GitLab
